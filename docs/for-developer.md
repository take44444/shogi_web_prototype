# 開発者のワークフロー


## 初期設定
### Node Package Managerのインストール
このプロジェクトでは[TypeScript](https://www.npmjs.com/package/typescript)、[React](https://www.npmjs.com/package/react)など様々なパッケージを利用しています。パッケージの管理(依存するモジュールを含めたインストール、バージョン管理など)をかんたんに行えるように、このプロジェクトはパッケージマネージャーとして **Node Package Manager (npm)** を利用しています。開発にはnpmが必要なのでインストールしてください。

### 依存パッケージのインストール
プロジェクトで利用し、インストールする必要のあるパッケージは`/package.json`の`devDependencies`及び`dependencies`に記載されています。必要なものは以下のコマンドでインストールできます。
```shell
npm install
```
以上のコマンドを実行すると`/node_modules`というディレクトリが作られここにパッケージが保存されます。このディレクトリ内にはパッケージのモジュールファイルが多く保存されますが、これらを本プロジェクトの開発者が編集することはないので、このディレクトリは`.gitignore`で変更を監視しないように設定しています。したがって、`git pull`するたびに、あるいは`package.json`が変更されるたびに`npm install`を行う必要があります。

## ビルドと実行
`package.json`にはいくつかのスクリプトが定義されています。詳細は`package.json`に記載を参照するとして、ここではいくつか主要なビルドと実行のコマンドを記載します。
### 開発用ビルドとサーバー立ち上げ
```shell
npm run start
```
このコマンドを実行すると、ブラウザから`http://localhost:5000`でアプリにアクセスできるようになります。下記**開発用ビルド**を実行した後、`npx serve`を実行したのと同じ結果です。

### 本番用ビルド
```shell
npm run build
```
`pre-build-script.js`が実行された後、TypeScriptをJavaScriptのブラウザ用ES6にトランスパイルし、`import/export`を解決してバンドルし、jsファイルとcssファイルを出力します。また、それらへのリンクを挿入したhtmlファイルも出力します。出力先は`/dist`です。  

### 開発用ビルド
```shell
npm run build-dev
```
実行内容は**本番用ビルド**と同様ですが、こちらは開発用にビルドします。

## パッケージのインストールと利用
### 新たなパッケージのインストール
もし新しく `new-package` というパッケージをインストールする場合は、以下のコマンドでインストールできます。

```shell
npm install --save-dev new-package
```

ここで `--save-dev` オプション(`-D`と同義)はローカルに開発者モードとしてインストールするという意味です。複数人で開発する場合はこの設定がベストだと思うので、**リファレンス等で `-g` 等別のオプションが設定されていた場合は適宜 `--save-dev` オプションに変えてください**。  
新しいパッケージがインストールされたらその情報が `/package.json` に追加されます。他のユーザーは再び `npm install` コマンドで不足するパッケージをインストールできます。  

### パッケージの実行  
例えばこのプロジェクトでは `serve` というパッケージを導入しています。これは簡易サーバーを起動することができるパッケージで、`serve`コマンドを実行すると`http://localhost:5000`でアクセスできるようになります。  
ここで、インストールしたパッケージを実行するには `npx` コマンドを利用してください。先程の`serve`コマンドに実行は、
```shell
npx serve
```
で実行することができます。

## webpack
webpackの設定は、本番・開発に共通なものは`webpack.common.js`に、本番のみ、開発のみの設定はそれぞれ`webpack.prod.js`、`webpack.dev.js`に記載しています。  
webpackが行う操作は大きく次のとおりです。
- `src/index.tsx`をエントリーポイントとする
- TypeScript、JSXをJavaScriptにトランスパイルする
- `import/export`をたどりjsファイルとcssファイルにバンドルする
- 生成したjsファイルcssファイルへのリンクを`public/index.html`に挿入する
- できたファイルを`dist`ディレクトリに出力する

## ESLint
本プロジェクトでは静的コード解析ツールの**ESLint**を導入しています。基本的にこれにしたがってください。設定は`.eslintrc.yml`に記載しています。

## Prettier
本プロジェクトではコード整形ツールの**Prettier**を導入しています。基本的にこれにしたがってください。設定は`.prettierrc.yml`に記載しています。

## React
本プロジェクトはUIライブラリとしてReactを導入しています。Reactに関して本プロジェクト固有のルールを以下に記します。
- 特に理由がない場合はコンポーネントは**Functional Component**と**Hooks**で記述する
- 特に理由がない場合はDOMの生成は**JSX**で記述する
- JSXを返す可能性のある関数は**PascalCase**で、そうでない関数は**camelCase**で命名する
- JSXを利用するスクリプトファイルの拡張子は`.tsx`で、そうでないものは必ず`.ts`にする